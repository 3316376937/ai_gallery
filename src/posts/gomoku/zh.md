---
title: Claude3.5 实现完整单机五子棋
date: '2024-10-16'
tags: ['claude']
keywords: ['Claude3.5 辅助前端', '在线五子棋', '免费五子棋']
description: 用 Claude3.5 实现一个完整的单机五子棋游戏，支持各种禁手规则。如何更好的利用 AI 解决复杂问题，并让 AI 写测试用例来保证逻辑的正确性，本文会给你一个答案。
---

五子棋是一个比较简单的棋类游戏，规则比较简单，如果用 Claude3.5 来实现，可能一句话就能实现一个简单版本的五子棋了。不过仔细研究了五子棋的禁手规则后，发现还是有点复杂的。五子棋的规则包含了各种禁手规则，比如三三禁手、四四禁手、长连禁手等。

如果用 Claude3.5 来实现禁手，会有难度吗？对于复杂的规则，当使用 Claude 辅助开发的时候，如何才能保证实现的正确性？本文记录用 Claude 实现单机五子棋的完整过程，一起来体会和 AI 结对编程的乐趣。

![单机版五子棋，支持各种禁手规则](https://slefboot-1251736664.file.myqcloud.com/20241016_ai_gallery_gomoku_blogcover.png)

## 拆分子问题

继续拆分。先单独实现一个连续活三的检测。对于一个落点，检查前、后两个点是否是是同一方，之后检测两段是否是空白的。比如落点 X，连续活三有两种情况：

```
_00X_
_X00_
```

在满足1 种的情况下就是活三。

用模式匹配的方法来，检测冲四：
1. 连续的四子加一个空位（WBBBBX），这种另一端是对方或者边界；
2. 中间有一个空位的四子（BBBXB），这里是对称，左右都可以；
3. 两端各有两个子的冲四（BBXBB），棋子要在中间。

扫描 row,col 周边的点，保证有 3 个同样的 player 以及一个空格。
如果空格在最边的一端位置，还要保证另一端有阻挡（对手棋子或者边界）
下面 1 代表边界或者对手棋子，_ 代表空格，X代表检测冲四的棋子位置。0 代表先手棋子。

比如下面都是冲四：
10_X00 
0_X000

重修修改这里，不单独判断冲四。直接增加一个计算活四或者冲四连接的方法。

对于某个先手落子，算出再下一个棋子会五连的所有情况。
对于每一种五连，记录用到的当前 4 个棋子的位置，以及需要再下棋子的位置。

然后按照用到的 4连棋子的位置进行聚合，计算出每种情况下，需要下的棋子的位置，如果对于某四个棋子，只有一个位置可以行成五连，就是冲四。有两个位置可以形成五连，就是活四。

函数返回两部分，一个是冲四的棋子位置，一个是活四的棋子位置

## 测试用例

