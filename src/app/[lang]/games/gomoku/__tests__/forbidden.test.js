import { checkDoubleThree, findXPositionAndReplace } from '../move';

describe('Gomoku checkDoubleThree', () => {
  const testCases = [
    {
      name: "Double continuous open threes",
      board: [
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "B", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "B", "X", "B", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "B", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""]
      ],
      player: "B",
      expectedResult: {
        isForbidden: true,
        forbiddenPositions: [ [ 6, 5 ], [ 6, 6 ], [ 6, 7 ], [ 5, 6 ], [ 7, 6 ] ] ,
        openThreesCount: 2
      }
    },
    {
      name: "Double open threes with four",
      board: [
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "B", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "B", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "X", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "B", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["B", "", "B", "", "B", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "B", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""]
      ],
      player: "B",
      expectedResult: {
        isForbidden: true,
        forbiddenPositions: [ [ 10, 2 ], [ 11, 2 ], [ 12, 2 ], [ 9, 3 ], [ 8, 4 ] ],
        openThreesCount: 2
      }
    },
    {
      name: "Two jump threes",
      board: [
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "B", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "X", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "B", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "B", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "B", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""]
      ],
      player: "B",
      expectedResult: {
        isForbidden: true,
        forbiddenPositions: [[ 6, 6 ], [ 8, 8 ], [ 9, 9 ], [ 7, 5 ], [ 4, 8 ]],
        openThreesCount: 2
      }
    },
    {
      name: "Three open threes",
      board: [
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "X", "B", "B", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "B", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "B", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "B", "", "", "B", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", "", "", "", ""]
      ],
      player: "B",
      expectedResult: {
        isForbidden: true,
        forbiddenPositions: [
          [ 5, 5 ], [ 5, 6 ],
          [ 5, 7 ], [ 7, 5 ],
          [ 8, 5 ], [ 6, 6 ],
          [ 8, 8 ]
        ],
        openThreesCount: 3
      }
    }
  ];

  testCases.forEach(testCase => {
    test(testCase.name, () => {
      const { position: [row, col], board: updatedBoard } = findXPositionAndReplace(testCase.board, testCase.player);
      const result = checkDoubleThree(updatedBoard, row, col, testCase.player);
      
      expect(result.isForbidden).toBe(testCase.expectedResult.isForbidden);
      expect(result.forbiddenPositions).toEqual(testCase.expectedResult.forbiddenPositions);
      expect(result.openThrees.length).toBe(testCase.expectedResult.openThreesCount);
    });
  });
});
